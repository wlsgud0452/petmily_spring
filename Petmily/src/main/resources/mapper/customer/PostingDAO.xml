<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTO 3.0//EN"
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
						
<mapper namespace="com.petmily.customer.dao.PostingDAO">

	<select id="postingListRow" resultType="Integer">
		select count(*) from posting where pdeletedate is null and pcategory =#{pcategory}
	</select>
	
	<select id="postingGetList" resultType="com.petmily.customer.dto.PostingDTO">
		select pid, ptitle, plocation, pinitdate, user_uid, pcategory from posting 
		where pcategory = #{pcategory} and pdeletedate is null and ${option} 
		like #{query} order by pid desc limit #{start} ,#{rowLength}
	</select>
	
	
	<select id="acceptPostingList" resultType="com.petmily.customer.dto.PostingDTO">
		select p.pid , p.user_uid , p.pcategory , p.ptitle , p.pinitdate , p.plocation
		from posting p inner join apply a
		where p.pid = a.posting_pid and a.user_uid = #{uid} 
		and a.apcanceldate is null and a.apmatchingdate is not null and a.apcompletedate is null
		order by a.apmatchingdate limit #{start}, #{rowLength}
	</select>
	
</mapper>